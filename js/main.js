$(function(){({initialize:function(){this.plugins(),this.listeners(),this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3)},listeners:function(){$(document).click(this.popup),$('[data-modal*="modal"]').click(this.openModal),$(document).on("click",this.closeModal),$(document).on("click",".viewport__nav",this.aboutViewportNavClick.bind(this)),$(document).on("mouseover mouseout",".viewport__slides",this.aboutViewportStop.bind(this)),$(document).on("mouseout",".viewport__slides",this.aboutViewportStart.bind(this))},plugins:function(){$(".select").selectric({onChange:this.selectricOnChange,onInit:this.selectricOnInit,multiple:{separator:", ",keepMenuOpen:!0,maxLabelEntries:!1}})},selectricOnInit:function(t){var i=$(t),e=i.find("option[data-disabled]").text(),a=i.parents(".selectric-select"),n=a.find(".selectric"),s=a.find(".selectric .label");s.removeClass("disabled"),s.text()===e&&s.addClass("disabled"),i.attr("multiple")&&i.val().length?(n.addClass("active"),n.find(".cancel").length||n.append('<div class="cancel"><span></span></div>')):(n.removeClass("active"),n.find(".cancel").remove())},selectricOnChange:function(t){var i=$(t),e=i.find("option[data-disabled]").text(),a=i.parents(".selectric-select");if(i.parents(".owner-main__select")){i.find("option"),a.find(".selectric-items .selected")}var n=a.find(".selectric"),s=a.find(".selectric .label");s.removeClass("disabled"),s.text()===e&&s.addClass("disabled"),i.attr("multiple")&&i.val().length?(n.addClass("active"),n.find(".cancel").length||n.append('<div class="cancel"><span></span></div>')):(n.removeClass("active"),n.find(".cancel").remove())},popup:function(t){var i=$(t.target),e=100;if(i.is("[data-popup=click]")||i.parents("[data-popup=click]").length){var a=i.attr("data-href")||i.parents("[data-popup=click]").attr("data-href");$("[data-popup=window].active:not("+a+")").css("opacity",0).removeClass("active");var n=$(a);return void(n.is(".active")?n.stop().animate({opacity:"0"},e,function(){n.removeClass("active")}):n.addClass("active").stop().animate({opacity:"1"},e))}if(!i.is("[data-popup=window]")&&!i.parents("[data-popup=window]").length){var s=$("[data-popup=window]"),e=100;s.stop().animate({opacity:"0"},e),setTimeout(function(){s.removeClass("active")},2*e)}},openModal:function(t){t.preventDefault();var i=$(this).attr("data-modal");$("[data-id="+i+"]").addClass("active")},closeModal:function(t){($(t.target).is("#modal-close")||$(t.target).is("#modal-sub")||$(t.target).is("#modal")&&!$(t.target).find("#modal-sub").length)&&$("[id=modal]").removeClass("active")},aboutViewportChanging:function(){var t,i,e=$(".viewport"),a=e.find(".viewport__slide.active"),n=e.find(".viewport__nav.active");0===a.next().length?(t=n.siblings(".viewport__nav:first-child"),i=a.siblings(".viewport__slide:first-child")):(i=a.next(),t=n.next()),this.aboutSlidesSwitching(a,n,i,t)},aboutViewportNavClick:function(t){var i=$(t.currentTarget),e=i.parents(".viewport");if(e.find(".showing").length||i.is(".active"))return!1;clearInterval(this.aboutInterval),this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3);var a=i.siblings(".active"),n=i.index()+1,s=e.find(".viewport__slide:nth-child("+n+")"),o=e.find(".viewport__slide.active");this.aboutSlidesSwitching(o,a,s,i)},aboutSlidesSwitching:function(t,i,e,a){var n=t.find("img"),s=t.find("h3, p"),o=e.find("img"),l=e.find("h3, p");i.removeClass("active"),a.addClass("active"),t.addClass("hidding"),e.addClass("showing active"),o.css("opacity","1"),s.removeClass("active"),l.addClass("active"),n.animate({opacity:"0"},1e3,function(){e.removeClass("showing"),t.removeClass("hidding active")})},aboutViewportStop:function(t){clearInterval(this.aboutInterval)},aboutViewportStart:function(t){this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3)}}).initialize()});
function hideText(){$(".text").each(function(){var t=$(this),e={};if(!t.is("[data-expand-strings], [data-expand-words]"))return!1;if(e.type=t.is("[data-expand-strings]")?"strings":"words",e.number="strings"===e.type?t.attr("data-expand-strings"):t.attr("data-expand-words"),"strings"===e.type){var a=parseInt(t.css("line-height")),r=e.number*a;t.attr("data-height",t.height()),t.css("height",r+"px")}if("words"===e.type){var i=t.find(".expand-text"),n=new RegExp("([а-яА-Яa-zA-Z,]+\\s){"+(e.number-1)+"}[а-яА-Яa-zA-Z]+","mi"),s=t.text().trim().replace(n,"");t.attr("data-text",s),t.text(t.text().trim().match(n)+" ... "),t.append(i)}})}function expandText(){var t=$(this),e=t.parents(".text").length?t.parents(".text"):t.siblings(".text");e.attr("data-height")&&(e.css("height",e.attr("data-height")),t.remove()),e.attr("data-text")&&(t.remove(),e.text(e.text().trim().replace(/\.{3}$/im,"")+e.attr("data-text")))}
$(function(){({initialize:function(){this.plugins(),this.listeners(),hideText(),this.sidebarBehavior(),this.statusbars(),this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3)},startValues:{sideOffset:$("aside").length?$("aside").offset().top:0,sideParentHeight:$("aside").length?$("aside").parent().height():0,windowPrevPosition:$(window).scrollTop(),multipleSelectricValues:[]},listeners:function(){$(".expand-text").click(expandText),$(".select-box_multiple").on("click",".cancel",this.clearMultiselect),$(document).click(this.popup),$("[id=commenting-input]").focus(this.npWrite),$("[id=commenting-input]").focusout(this.npClose),$("[id=commenting-input]").on("keydown keyup",this.npWriting),$('[data-modal*="modal"]').click(this.openModal),$(document).on("click",this.closeModal),$("[id=review-other]").click(this.showReviewTooltip),$(document).click(this.hideReviewTooltip),$("[id=add-review] textarea").focus(this.showAddReview),$("[id=add-review] textarea").focusout(this.hideAddReview),$("[id=activity-share]").click(this.showShare),$(document).click(this.hideShare),$("#catfilter-switcher").click(this.switchCats),$(window).scroll(this.sidebarBehavior.bind(this)),$(document).on("click",".viewport__nav",this.aboutViewportNavClick.bind(this)),$(document).on("mouseover mouseout",".viewport__slides",this.aboutViewportStop.bind(this)),$(document).on("mouseout",".viewport__slides",this.aboutViewportStart.bind(this)),$(document).on("click",'[href="#time-remove"]',this.scheduleRemover),$(document).on("change focusout","input[data-mask]",this.socialsValidationShow),$(document).on("focus","input[data-mask]",this.socialsValidationHide),$(".head-user__menu-item_projects").hover(this.headerMenuHover)},plugins:function(){$(".select").selectric({onChange:this.selectricOnChange,onInit:this.selectricOnInit,multiple:{separator:", ",keepMenuOpen:!0,maxLabelEntries:!1}}),$(".rating").rateit({min:0,max:5,resetable:!1,starwidth:20,starheight:18}),$(".rating_12").rateit({min:0,max:5,resetable:!1,starwidth:14,starheight:12}),$(".rating_13").rateit({min:0,max:5,resetable:!1,starwidth:15,starheight:13}),$(".rating_14").rateit({min:0,max:5,resetable:!1,starwidth:16,starheight:14}),$.mask.definitions.h="[0-2]",$.mask.definitions.e="[0-9]",$.mask.definitions.m="[0-5]",$("[data-valid=time]").mask("he:m9")},selectricOnInit:function(t){var e=$(t),i=e.find("option[data-disabled]").text(),a=e.parents(".selectric-select"),s=a.find(".selectric"),n=a.find(".selectric .label");n.removeClass("disabled"),n.text()===i&&n.addClass("disabled"),e.attr("multiple")&&e.val().length?(s.addClass("active"),s.find(".cancel").length||s.append('<div class="cancel"><span></span></div>')):(s.removeClass("active"),s.find(".cancel").remove())},selectricOnChange:function(t){var e=$(t),i=e.find("option[data-disabled]").text(),a=e.parents(".selectric-select");if(e.parents(".owner-main__select")){var s=(e.find("option"),a.find(".selectric-items .selected"));s.length>=3?a.find(".selectric-items li:not(.selected)").each(function(){var t=$(this),i=t.index();t.addClass("disabled"),e.find("option:nth-child("+(i+1)+")").prop("disabled",!0)}):2==s.length&&e.find("option:disabled").length}var n=a.find(".selectric"),o=a.find(".selectric .label");o.removeClass("disabled"),o.text()===i&&o.addClass("disabled"),e.attr("multiple")&&e.val().length?(n.addClass("active"),n.find(".cancel").length||n.append('<div class="cancel"><span></span></div>')):(n.removeClass("active"),n.find(".cancel").remove())},selectricBeforeChange:function(t,e,i){},clearMultiselect:function(t){t.preventDefault(),$(this).parents(".selectric-select").find(".selectric-items li.selected").each(function(){$(this).click()}),$(this).remove()},popup:function(t){var e=$(t.target),i=100;if(e.is("[data-popup=click]")||e.parents("[data-popup=click]").length){var a=e.attr("data-href")||e.parents("[data-popup=click]").attr("data-href");return void $("[data-popup=window].active:not("+a+")").css("opacity",0).removeClass("active",function(){var t=$(a);t.is(".active")?t.stop().animate({opacity:"0"},i,function(){t.removeClass("active")}):t.addClass("active").stop().animate({opacity:"1"},i)})}if(!e.is("[data-popup=window]")&&!e.parents("[data-popup=window]").length){var s=$("[data-popup=window]"),i=100;s.stop().animate({opacity:"0"},i),setTimeout(function(){s.removeClass("active")},2*i)}},npWrite:function(){var t=$(this),e=t.parents("#commenting-parent").find("#commenting-foot");e.slideDown(100,function(){e.addClass("active")})},npClose:function(){var t=$(this),e=t.parents("#commenting-parent").find("#commenting-foot");e.slideUp(200,function(){e.removeClass("active")})},npWriting:function(){var t=$(this),e=t.val().length,i=t.parents("#commenting-parent").find("#commenting-count");i.text(i.text().trim().replace(/^\d+\s/i,e+" "))},openModal:function(t){t.preventDefault();var e=$(this).attr("data-modal");$("[data-id="+e+"]").addClass("active")},closeModal:function(t){($(t.target).is("#modal-close")||$(t.target).is("#modal-sub")||$(t.target).is("#modal")&&!$(t.target).find("#modal-sub").length)&&$("[id=modal]").removeClass("active")},showReviewTooltip:function(){$(this).find("#review-tooltip").toggleClass("active")},hideReviewTooltip:function(t){$(t.target).is("[id=review-tooltip]")||$(t.target).is("[id=review-other]")||$("[id=review-tooltip]").removeClass("active")},showAddReview:function(){var t=$(this);t.addClass("active"),t.prev().addClass("active"),t.next().addClass("active")},hideAddReview:function(){var t=$(this);t.val().length||(t.removeClass("active"),t.prev().removeClass("active"),t.next().removeClass("active"))},showShare:function(){$(this).siblings("#activity-socials").toggleClass("active")},hideShare:function(t){$(t.target).is("#activity-share")||$(t.target).is("#activity-socials")||$("[id=activity-socials]").removeClass("active")},switchCats:function(){var t=$(this),e=t.text();t.parents("#cat-filter").find("ul.active").removeClass("active").siblings("ul").addClass("active"),t.text(t.attr("data-alt")).attr("data-alt",e)},sidebarBehavior:function(t){var e=$("aside");if(e.length){var i=e.next(),a=$(".footer"),s=$(window).height(),n=this.startValues.windowPrevPosition,o=$(window).scrollTop(),l=o-n,d=this.startValues.sideOffset,r=e.height(),c=e.outerWidth()+parseInt(e.css("margin-right")),h=e.offset().top,v=(e.css("padding-top"),e.css("padding-bottom"),a.offset().top),u=a.outerHeight(),p=this.startValues.sideParentHeight;if(p<=r)return!1;r+80<s?(o>d-20&&o+(r+60)<v&&(i.length&&i.css("margin-left",c),e.addClass("fixed"),e.removeClass("absolute")),o<=d-20&&(e.removeClass("fixed"),e.removeClass("absolute"),i.attr("style","")),o>d-20&&o+(r+60)>=v&&(i.length&&i.css("margin-left",c),e.removeClass("fixed"),e.addClass("absolute"),e.css("bottom",u+40))):(l>0&&(o+s>=v?(e.removeClass("fixed fixed_tall"),e.addClass("absolute"),e.css("bottom",u+40)):o+s>=h+r+40?(i.length&&i.css("margin-left",c),e.addClass("fixed fixed_tall"),e.removeClass("absolute"),e.css("top",""),e.css("bottom",40)):o+s>h&&(i.length&&i.css("margin-left",c),e.removeClass("fixed"),e.addClass("absolute"),e.css("bottom",""),e.css("top",h))),l<0&&(o<=d-20?(e.removeClass("fixed fixed_tall"),e.removeClass("absolute"),i.attr("style",""),e.attr("style","")):o<=h-20?(i.length&&i.css("margin-left",c),e.addClass("fixed fixed_tall"),e.removeClass("absolute"),e.css("bottom",""),e.css("top",20)):o<h+r&&(i.length&&i.css("margin-left",c),e.removeClass("fixed fixed_tall"),e.addClass("absolute"),e.css("bottom",""),e.css("top",h)))),this.startValues.windowPrevPosition=o}},statusbars:function(){$("[data-statusbar]").each(function(){var t=$(this),e=t.attr("data-statusbar"),i=t.attr("data-complete");t.find("[class*=complete]").css("width",i/e*100+"%")})},aboutViewportChanging:function(){var t,e,i=$(".viewport"),a=i.find(".viewport__slide.active"),s=i.find(".viewport__nav.active");0===a.next().length?(t=s.siblings(".viewport__nav:first-child"),e=a.siblings(".viewport__slide:first-child")):(e=a.next(),t=s.next()),this.aboutSlidesSwitching(a,s,e,t)},aboutViewportNavClick:function(t){var e=$(t.currentTarget),i=e.parents(".viewport");if(i.find(".showing").length||e.is(".active"))return!1;clearInterval(this.aboutInterval),this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3);var a=e.siblings(".active"),s=e.index()+1,n=i.find(".viewport__slide:nth-child("+s+")"),o=i.find(".viewport__slide.active");this.aboutSlidesSwitching(o,a,n,e)},aboutSlidesSwitching:function(t,e,i,a){var s=t.find("img"),n=t.find("h3, p"),o=i.find("img"),l=i.find("h3, p");e.removeClass("active"),a.addClass("active"),t.addClass("hidding"),i.addClass("showing active"),o.css("opacity","1"),n.removeClass("active"),l.addClass("active"),s.animate({opacity:"0"},1e3,function(){i.removeClass("showing"),t.removeClass("hidding active")})},aboutViewportStop:function(t){clearInterval(this.aboutInterval)},aboutViewportStart:function(t){this.aboutInterval=setInterval(this.aboutViewportChanging.bind(this),5e3)},scheduleRemover:function(t){t.preventDefault();var e=$(this),i=e.parents(".owner-schedule__times");e.parents(".schedule-time").remove(),i.find(".schedule-time").length||i.parent().remove()},socialsValidationShow:function(){var t=$(this),e=t.val(),i=t.attr("data-mask");e&&0!==e.indexOf(i)&&(t.next().show(),t.addClass("text-input_error"))},socialsValidationHide:function(){var t=$(this);t.next().hide(),t.removeClass("text-input_error")},headerMenuHover:function(t){var e=$(this),i=e.find("ul"),a=e.offset().left+220+220;$(window).innerWidth()<=a?i.css({right:"220px",left:"auto"}):i.css({left:"220px",right:"auto"}),i.toggleClass("active")},addNull:function(t){return 0===t.length?"00":t.length>1?"0"+t:t}}).initialize()});
function mapInit(){myMap=new ymaps.Map("map",{center:[48.7,44.51],zoom:9})}function googleMapInit(){var n,e=$("#owner-coords"),a=document.getElementById("address-map"),o=e.val()||"1 1",t={lat:Number(o.substring(0,o.indexOf(","))),lng:Number(o.substring(o.indexOf(" ")))};if(a){var i=new google.maps.Map(a,{center:t,zoom:t.lat?8:2});t.lat&&t.lng&&(n=new google.maps.Marker({position:t,map:i})),i.addListener("click",function(a){var o={lat:Number(a.latLng.lat().toFixed(6)),lng:Number(a.latLng.lng().toFixed(6))},t=o.lat+", "+o.lng;e.val(t),n.setPosition(o)})}}$(function(){if(window.ymaps){ymaps.ready(mapInit)}window.google&&google.maps.event.addDomListener(window,"load",googleMapInit)});